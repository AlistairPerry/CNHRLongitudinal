
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>plotNBSinteractions</title><meta name="generator" content="MATLAB 8.6"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2018-01-01"><meta name="DC.source" content="plotNBSinteractions.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><pre class="codeinput"><span class="keyword">function</span> plotNBSinteractions(nbsfile, connectivitymats, grptimeinfo, ages, grplabels, baseoutputstring)
<span class="comment">% Construct plots to guide interpretation of significant group x time</span>
<span class="comment">% interactions derived from the NBS</span>
<span class="comment">% USAGE plotNBSinteractions(nbsfile, connectivitymats, grptimeinfo, ages, grplabels)</span>

<span class="comment">%Inputs:</span>
<span class="comment">%1. _nbsfile_: Filename of saved NBS output structure</span>

<span class="comment">%And pre-loaded within matlab workspace</span>
<span class="comment">%2. _Connectivitymats_: Connectivity matrices of all subjects (_N_) concatenated within a 3D matrix</span>
<span class="comment">%3. _grptimeinfo_: _N_ x 2 structure representing group (1st column) and</span>
<span class="comment">%time (2nd column) information of each individual (row)</span>
<span class="comment">% * where, first group is indexed by _1_, and the second group _-1_</span>
<span class="comment">% * and, time one (baseline) denoted by _1_ and time two (follow up) as _-1_</span>

<span class="comment">%4. _age_: Structure representing age of individuals at both baseline and</span>
<span class="comment">%followup</span>
<span class="comment">% * NOTE: Ordering of subjects group (and time) plus age information stored in vectors must match that stored within</span>
<span class="comment">% _connectivitymats_</span>

<span class="comment">%5. _grplabels_: Group labels identified within cell structure for plotting</span>
<span class="comment">% * For example, for control (CN) and high-risk (HR) groups, {'CN','HR'}</span>

<span class="comment">%6. _baseoutputstring_</span>

<span class="comment">%load nbs structure</span>
load(nbsfile);

<span class="comment">%identify rows referring to different time and groups</span>
GP1ind=find(grptimeinfo(:,1)==1);
GP2ind=find(grptimeinfo(:,1)==-1);

T1=find(grptimeinfo(:,2)==1);
T2=find(grptimeinfo(:,2)==-1);

<span class="comment">%find groups at different times</span>
GP1T1=intersect(T1,GP1ind);
GP1T2=intersect(T2,GP1ind);

GP2T1=intersect(T1,GP2ind);
GP2T2=intersect(T2,GP2ind);

<span class="comment">%extract ages for line fitting later on</span>
GP1T2ages=ages(GP1T2,:);
GP1T1ages=ages(GP1T1,:);
GP2T2ages=ages(GP2T2,:);
GP2T1ages=ages(GP2T1,:);

<span class="comment">%identify group time label strings for plots</span>
GP1T1label=[grplabels{1,1} <span class="string">' '</span> <span class="string">'Base'</span>];
GP1T2label=[grplabels{1,1} <span class="string">' '</span> <span class="string">'FU'</span>];

GP2T1label=[grplabels{1,2} <span class="string">' '</span> <span class="string">'Base'</span>];
GP2T2label=[grplabels{1,2} <span class="string">' '</span> <span class="string">'FU'</span>];

<span class="comment">%plots for each network identified within particular NBS threshold</span>
<span class="keyword">for</span> i = 1:length(nbs.NBS.con_mat(1,:))

    <span class="comment">%extract subject connectivity weights</span>
    <span class="comment">%as performed in extractNBSinformation.m</span>

    NBSweights=[];
    [xcol, ycol] = find(nbs.NBS.con_mat{1,i});
    <span class="keyword">for</span> k = 1:length(xcol)
        NBSweights(:,k)=squeeze(connectivitymats(xcol(k,1),ycol(k,1),:));
    <span class="keyword">end</span>

    NBSweightssum(:,i)=sum(NBSweights,2);

    <span class="comment">%now group connectivity weights at each time point</span>

    GP1T1net=[];
    GP2T1net=[];
    GP1T2net=[];
    GP2T2net=[];

    GP1T1net=NBSweightssum(GP1T1,i);
    GP2T1net=NBSweightssum(GP2T1,i);
    GP1T2net=NBSweightssum(GP1T2,i);
    GP2T2net=NBSweightssum(GP2T2,i);

    <span class="comment">%basic bar and sem plots</span>

    meanNBSgrpweights(i,:)=[mean(GP1T1net) mean(GP1T2net) mean(GP2T1net) mean(GP2T2net)];
    grpweightssem(i,:)=[std(GP1T1net)./sqrt(length(GP1T1net)) std(GP1T2net)./sqrt(length(GP1T2net)) std(GP2T1net)./sqrt(length(GP2T1net)) std(GP2T1net)./sqrt(length(GP2T2net))];

    <span class="comment">%group one</span>
    figure
    hold <span class="string">on</span>

    bar([1;2],[meanNBSgrpweights(i,1); meanNBSgrpweights(i,2)],<span class="string">'FaceColor'</span>,<span class="string">'k'</span>)

    hold <span class="string">on</span>

    <span class="comment">%group two</span>
    bar([3;4],[meanNBSgrpweights(i,3); meanNBSgrpweights(i,4)],<span class="string">'FaceColor'</span>,<span class="string">'r'</span>)
    errorbar(meanNBSgrpweights(i,:), grpweightssem(i,:),<span class="string">'k'</span>,<span class="string">'LineStyle'</span>,<span class="string">'none'</span>,<span class="string">'LineWidth'</span>,1)

    set(gca,<span class="string">'XTick'</span>,[1 2 3 4])
    set(gca,<span class="string">'box'</span>,<span class="string">'off'</span>)
    set(gca,<span class="string">'XTickLabel'</span>,{GP1T1label, GP1T2label, GP2T1label, GP2T2label})

    ylabel(<span class="string">'Mean Streamline Weights'</span>, <span class="string">'FontSize'</span>, 14, <span class="string">'FontWeight'</span>, <span class="string">'Bold'</span>, <span class="string">'Color'</span>, <span class="string">'black'</span>)
    xlabel(<span class="string">'Group and timepoint'</span>, <span class="string">'FontSize'</span>, 14, <span class="string">'FontWeight'</span>, <span class="string">'Bold'</span>, <span class="string">'Color'</span>, <span class="string">'black'</span>)

    ax=gca;
    ax.YColor = <span class="string">'black'</span>;
    ax.XColor = <span class="string">'black'</span>;
    ax.FontWeight = <span class="string">'bold'</span>;
    ax.FontSize = 12;

    <span class="comment">%ax.XTickLabel=[GP1T1label, GP1T2label, GP2T1label, GP2T2label];</span>

    hold <span class="string">off</span>

    <span class="comment">%distribution plots for each group and time point</span>

    weightscell={GP1T1net,GP1T2net,GP2T1net,GP2T2net};
    figure,plotSpread_incmarkersz(weightscell,<span class="string">'distributionColors'</span>,{<span class="string">'k'</span>,<span class="string">'k'</span>,<span class="string">'r'</span>,<span class="string">'r'</span>})

    set(gca,<span class="string">'XTick'</span>,[1 2 3 4])
    set(gca,<span class="string">'box'</span>,<span class="string">'off'</span>)
    set(gca,<span class="string">'XTickLabel'</span>,{GP1T1label, GP1T2label, GP2T1label, GP2T2label})

    ylabel(<span class="string">'Streamline Weights'</span>, <span class="string">'FontSize'</span>, 14, <span class="string">'FontWeight'</span>, <span class="string">'Bold'</span>, <span class="string">'Color'</span>, <span class="string">'black'</span>)
    xlabel(<span class="string">'Group and timepoint'</span>, <span class="string">'FontSize'</span>, 14, <span class="string">'FontWeight'</span>, <span class="string">'Bold'</span>, <span class="string">'Color'</span>, <span class="string">'black'</span>)

    ax=gca;
    ax.YColor = <span class="string">'black'</span>;
    ax.XColor = <span class="string">'black'</span>;
    ax.FontWeight = <span class="string">'bold'</span>;
    ax.FontSize = 12;

    hold <span class="string">off</span>

    figure
    hold <span class="string">on</span>

    <span class="comment">%plot individuals across each group and their connectivity trajectories</span>
    <span class="comment">%first group one</span>

    <span class="keyword">for</span> j = 1:length(GP1T1)
        plot([GP1T1ages(j,1) GP1T2ages(j,1)], [GP1T1net(j,1) GP1T2net(j,1)],<span class="string">'-k'</span>,<span class="string">'LineWidth'</span>,1,<span class="string">'Marker'</span>,<span class="string">'o'</span>,<span class="string">'MarkerFaceColor'</span>,<span class="string">'k'</span>,<span class="string">'MarkerEdgeColor'</span>,<span class="string">'k'</span>,<span class="string">'MarkerSize'</span>,6)
    <span class="keyword">end</span>

    <span class="comment">%now group two</span>

    <span class="keyword">for</span> j = 1:length(GP2T1)
        plot([GP2T1ages(j,1) GP2T2ages(j,1)], [GP2T1net(j,1) GP2T2net(j,1)],<span class="string">'-r'</span>,<span class="string">'LineWidth'</span>,1,<span class="string">'Marker'</span>,<span class="string">'o'</span>,<span class="string">'MarkerFaceColor'</span>,<span class="string">'r'</span>,<span class="string">'MarkerEdgeColor'</span>,<span class="string">'k'</span>,<span class="string">'MarkerSize'</span>,6)
    <span class="keyword">end</span>

    set(gca,<span class="string">'box'</span>,<span class="string">'off'</span>)

    ylabel(<span class="string">'Streamline Weights'</span>, <span class="string">'FontSize'</span>, 14, <span class="string">'FontWeight'</span>, <span class="string">'Bold'</span>, <span class="string">'Color'</span>, <span class="string">'black'</span>)
    xlabel(<span class="string">'Age'</span>, <span class="string">'FontSize'</span>, 14, <span class="string">'FontWeight'</span>, <span class="string">'Bold'</span>, <span class="string">'Color'</span>, <span class="string">'black'</span>)

    ax=gca;
    ax.YColor = <span class="string">'black'</span>;
    ax.XColor = <span class="string">'black'</span>;
    ax.FontWeight = <span class="string">'bold'</span>;
    ax.FontSize = 12;

    hold <span class="string">off</span>

    <span class="comment">%estimate and fit quadratics for each group at different points</span>

    agerg=min(ages):0.1:max(ages);

    <span class="comment">%Group 1, Time 1</span>
    p_GP1T1=polyfit(GP1T1ages,GP1T1net,2);
    y_GP1T1=polyval(p_GP1T1,agerg);
    figure, plot(agerg,y_GP1T1,<span class="string">'k'</span>,<span class="string">'linewidth'</span>,3)

    <span class="comment">%Group 1, Time 2</span>
    p_GP1T2=polyfit(GP1T2ages,GP1T2net,2);
    y_GP1T2=polyval(p_GP1T2,agerg);
    hold <span class="string">on</span>
    plot(agerg,y_GP1T2,<span class="string">'k--'</span>,<span class="string">'linewidth'</span>,3)

    <span class="comment">%Group 2, Time 1</span>
    p_GP2T1=polyfit(GP2T1ages,GP2T1net,2);
    y_GP2T1=polyval(p_GP2T1,agerg);
    plot(agerg,y_GP2T1,<span class="string">'r'</span>,<span class="string">'linewidth'</span>,3)

    <span class="comment">%Group 2, Time 2</span>
    p_GP2T2=polyfit(GP2T2ages,GP2T2net,2);
    y_GP2T2=polyval(p_GP2T2,agerg);
    plot(agerg,y_GP2T2,<span class="string">'r--'</span>,<span class="string">'linewidth'</span>,3)

    set(gca,<span class="string">'box'</span>,<span class="string">'off'</span>)

    ylabel(<span class="string">'Streamline Weights'</span>, <span class="string">'FontSize'</span>, 14, <span class="string">'FontWeight'</span>, <span class="string">'Bold'</span>, <span class="string">'Color'</span>, <span class="string">'black'</span>)
    xlabel(<span class="string">'Age'</span>, <span class="string">'FontSize'</span>, 14, <span class="string">'FontWeight'</span>, <span class="string">'Bold'</span>, <span class="string">'Color'</span>, <span class="string">'black'</span>)

    ax=gca;
    ax.YColor = <span class="string">'black'</span>;
    ax.XColor = <span class="string">'black'</span>;
    ax.FontWeight = <span class="string">'bold'</span>;
    ax.FontSize = 12;

    legend(<span class="string">'show'</span>,GP1T1label,GP1T2label,GP2T1label,GP2T2label,<span class="string">'Location'</span>,<span class="string">'SouthWest'</span>,<span class="string">'boxoff'</span>)

    hold <span class="string">off</span>
<span class="keyword">end</span>
<span class="keyword">end</span>
</pre><pre class="codeoutput error">Not enough input arguments.

Error in plotNBSinteractions (line 27)
load(nbsfile);
</pre><p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2015b</a><br></p></div><!--
##### SOURCE BEGIN #####
function plotNBSinteractions(nbsfile, connectivitymats, grptimeinfo, ages, grplabels, baseoutputstring)
% Construct plots to guide interpretation of significant group x time
% interactions derived from the NBS
% USAGE plotNBSinteractions(nbsfile, connectivitymats, grptimeinfo, ages, grplabels)

%Inputs:
%1. _nbsfile_: Filename of saved NBS output structure

%And pre-loaded within matlab workspace
%2. _Connectivitymats_: Connectivity matrices of all subjects (_N_) concatenated within a 3D matrix
%3. _grptimeinfo_: _N_ x 2 structure representing group (1st column) and
%time (2nd column) information of each individual (row)
% * where, first group is indexed by _1_, and the second group _-1_
% * and, time one (baseline) denoted by _1_ and time two (follow up) as _-1_

%4. _age_: Structure representing age of individuals at both baseline and
%followup
% * NOTE: Ordering of subjects group (and time) plus age information stored in vectors must match that stored within
% _connectivitymats_

%5. _grplabels_: Group labels identified within cell structure for plotting
% * For example, for control (CN) and high-risk (HR) groups, {'CN','HR'}

%6. _baseoutputstring_

%load nbs structure
load(nbsfile);

%identify rows referring to different time and groups
GP1ind=find(grptimeinfo(:,1)==1);
GP2ind=find(grptimeinfo(:,1)==-1);

T1=find(grptimeinfo(:,2)==1);
T2=find(grptimeinfo(:,2)==-1);

%find groups at different times
GP1T1=intersect(T1,GP1ind);
GP1T2=intersect(T2,GP1ind);

GP2T1=intersect(T1,GP2ind);
GP2T2=intersect(T2,GP2ind);

%extract ages for line fitting later on
GP1T2ages=ages(GP1T2,:);
GP1T1ages=ages(GP1T1,:);
GP2T2ages=ages(GP2T2,:);
GP2T1ages=ages(GP2T1,:);

%identify group time label strings for plots
GP1T1label=[grplabels{1,1} ' ' 'Base'];
GP1T2label=[grplabels{1,1} ' ' 'FU'];

GP2T1label=[grplabels{1,2} ' ' 'Base'];
GP2T2label=[grplabels{1,2} ' ' 'FU'];

%plots for each network identified within particular NBS threshold
for i = 1:length(nbs.NBS.con_mat(1,:))
    
    %extract subject connectivity weights
    %as performed in extractNBSinformation.m
    
    NBSweights=[];
    [xcol, ycol] = find(nbs.NBS.con_mat{1,i});
    for k = 1:length(xcol)
        NBSweights(:,k)=squeeze(connectivitymats(xcol(k,1),ycol(k,1),:));
    end
    
    NBSweightssum(:,i)=sum(NBSweights,2);
    
    %now group connectivity weights at each time point
    
    GP1T1net=[];
    GP2T1net=[];
    GP1T2net=[];
    GP2T2net=[];
    
    GP1T1net=NBSweightssum(GP1T1,i);
    GP2T1net=NBSweightssum(GP2T1,i);
    GP1T2net=NBSweightssum(GP1T2,i);
    GP2T2net=NBSweightssum(GP2T2,i);
    
    %basic bar and sem plots
    
    meanNBSgrpweights(i,:)=[mean(GP1T1net) mean(GP1T2net) mean(GP2T1net) mean(GP2T2net)];
    grpweightssem(i,:)=[std(GP1T1net)./sqrt(length(GP1T1net)) std(GP1T2net)./sqrt(length(GP1T2net)) std(GP2T1net)./sqrt(length(GP2T1net)) std(GP2T1net)./sqrt(length(GP2T2net))];
    
    %group one
    figure
    hold on
    
    bar([1;2],[meanNBSgrpweights(i,1); meanNBSgrpweights(i,2)],'FaceColor','k')
    
    hold on
    
    %group two
    bar([3;4],[meanNBSgrpweights(i,3); meanNBSgrpweights(i,4)],'FaceColor','r')
    errorbar(meanNBSgrpweights(i,:), grpweightssem(i,:),'k','LineStyle','none','LineWidth',1)
    
    set(gca,'XTick',[1 2 3 4])
    set(gca,'box','off')
    set(gca,'XTickLabel',{GP1T1label, GP1T2label, GP2T1label, GP2T2label})
    
    ylabel('Mean Streamline Weights', 'FontSize', 14, 'FontWeight', 'Bold', 'Color', 'black')
    xlabel('Group and timepoint', 'FontSize', 14, 'FontWeight', 'Bold', 'Color', 'black')
    
    ax=gca;
    ax.YColor = 'black';
    ax.XColor = 'black';
    ax.FontWeight = 'bold';
    ax.FontSize = 12;
    
    %ax.XTickLabel=[GP1T1label, GP1T2label, GP2T1label, GP2T2label];
    
    hold off
    
    %distribution plots for each group and time point
    
    weightscell={GP1T1net,GP1T2net,GP2T1net,GP2T2net};
    figure,plotSpread_incmarkersz(weightscell,'distributionColors',{'k','k','r','r'})
    
    set(gca,'XTick',[1 2 3 4])
    set(gca,'box','off')
    set(gca,'XTickLabel',{GP1T1label, GP1T2label, GP2T1label, GP2T2label})
    
    ylabel('Streamline Weights', 'FontSize', 14, 'FontWeight', 'Bold', 'Color', 'black')
    xlabel('Group and timepoint', 'FontSize', 14, 'FontWeight', 'Bold', 'Color', 'black')
    
    ax=gca;
    ax.YColor = 'black';
    ax.XColor = 'black';
    ax.FontWeight = 'bold';
    ax.FontSize = 12;
    
    hold off
    
    figure
    hold on
    
    %plot individuals across each group and their connectivity trajectories
    %first group one
    
    for j = 1:length(GP1T1)
        plot([GP1T1ages(j,1) GP1T2ages(j,1)], [GP1T1net(j,1) GP1T2net(j,1)],'-k','LineWidth',1,'Marker','o','MarkerFaceColor','k','MarkerEdgeColor','k','MarkerSize',6)
    end
    
    %now group two
    
    for j = 1:length(GP2T1)
        plot([GP2T1ages(j,1) GP2T2ages(j,1)], [GP2T1net(j,1) GP2T2net(j,1)],'-r','LineWidth',1,'Marker','o','MarkerFaceColor','r','MarkerEdgeColor','k','MarkerSize',6)
    end
    
    set(gca,'box','off')
    
    ylabel('Streamline Weights', 'FontSize', 14, 'FontWeight', 'Bold', 'Color', 'black')
    xlabel('Age', 'FontSize', 14, 'FontWeight', 'Bold', 'Color', 'black')
    
    ax=gca;
    ax.YColor = 'black';
    ax.XColor = 'black';
    ax.FontWeight = 'bold';
    ax.FontSize = 12;
    
    hold off
    
    %estimate and fit quadratics for each group at different points
    
    agerg=min(ages):0.1:max(ages);
    
    %Group 1, Time 1
    p_GP1T1=polyfit(GP1T1ages,GP1T1net,2);
    y_GP1T1=polyval(p_GP1T1,agerg);
    figure, plot(agerg,y_GP1T1,'k','linewidth',3)
    
    %Group 1, Time 2
    p_GP1T2=polyfit(GP1T2ages,GP1T2net,2);
    y_GP1T2=polyval(p_GP1T2,agerg);
    hold on
    plot(agerg,y_GP1T2,'kREPLACE_WITH_DASH_DASH','linewidth',3)
    
    %Group 2, Time 1
    p_GP2T1=polyfit(GP2T1ages,GP2T1net,2);
    y_GP2T1=polyval(p_GP2T1,agerg);
    plot(agerg,y_GP2T1,'r','linewidth',3)
    
    %Group 2, Time 2
    p_GP2T2=polyfit(GP2T2ages,GP2T2net,2);
    y_GP2T2=polyval(p_GP2T2,agerg);
    plot(agerg,y_GP2T2,'rREPLACE_WITH_DASH_DASH','linewidth',3)
    
    set(gca,'box','off')
    
    ylabel('Streamline Weights', 'FontSize', 14, 'FontWeight', 'Bold', 'Color', 'black')
    xlabel('Age', 'FontSize', 14, 'FontWeight', 'Bold', 'Color', 'black')
    
    ax=gca;
    ax.YColor = 'black';
    ax.XColor = 'black';
    ax.FontWeight = 'bold';
    ax.FontSize = 12;
    
    legend('show',GP1T1label,GP1T2label,GP2T1label,GP2T2label,'Location','SouthWest','boxoff')
    
    hold off
end
end
##### SOURCE END #####
--></body></html>